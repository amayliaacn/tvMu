<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>Buku Besar - tvMu</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="assets/img/tvmu.jpeg" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="assets/vendor/quill/quill.snow.css" rel="stylesheet">
    <link href="assets/vendor/quill/quill.bubble.css" rel="stylesheet">
    <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
    <link href="assets/vendor/simple-datatables/style.css" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">

    <!-- =======================================================
  * Template Name: NiceAdmin
  * Template URL: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/
  * Updated: Apr 20 2024 with Bootstrap v5.3.3
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
</head>

<body>

    <!-- ======= Header ======= -->
    <header id="header" class="header fixed-top d-flex align-items-center">

        <div class="d-flex align-items-center justify-content-between">
            <a href="index.html" class="logo d-flex align-items-center">
                <!img src="assets/img/logo.png" alt="">
                    <div class="ps-2">
                        <span class="d-none d-lg-block">Tv Muhammadiyah</span>
                    </div>
            </a>
            <i class="bi bi-list toggle-sidebar-btn"></i>
        </div><!-- End Logo -->

        <nav class="header-nav ms-auto">
            <ul class="d-flex align-items-center">

                <li class="nav-item d-block d-lg-none">
                    <a class="nav-link nav-icon search-bar-toggle " href="#">
                        <i class="bi bi-search"></i>
                    </a>
                </li><!-- End Search Icon-->

                <!-- Profile -->
                <li class="nav-item dropdown pe-3">

                    <a class="nav-link nav-profile d-flex align-items-center pe-0" href="#" data-bs-toggle="dropdown">
                        <img src="assets/img/kucing.jpeg" alt="Profile" class="rounded-circle">
                        <span class="d-none d-md-block dropdown-toggle ps-2">Jemari</span>
                    </a><!-- End Profile Iamge Icon -->

                    <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
                        <li class="dropdown-header">
                            <h6>Jemari</h6>
                            <span>Staff Accounting</span>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li>
                            <a class="dropdown-item d-flex align-items-center" href="profile.html">
                                <i class="bi bi-person"></i>
                                <span>My Profile</span>
                            </a>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>

                        <li>
                            <a class="dropdown-item d-flex align-items-center" href="index.html">
                                <i class="bi bi-box-arrow-right"></i>
                                <span>Sign Out</span>
                            </a>
                        </li>

                    </ul><!-- End Profile Dropdown Items -->
                </li><!-- End Profile Nav -->

            </ul>
        </nav><!-- End Icons Navigation -->

    </header><!-- End Header -->

    <!-- ======= Sidebar ======= -->
    <aside id="sidebar" class="sidebar">

        <ul class="sidebar-nav" id="sidebar-nav">

            <li class="nav-item">
                <a class="nav-link collapsed" href="dashboard.html">
                    <i class="bi bi-grid"></i>
                    <span>Dashboard</span>
                </a>
            </li><!-- End Dashboard Nav -->

            <li class="nav-item">
                <a class="nav-link collapsed" href="akun.html">
                    <i class="bi bi-menu-button-wide"></i><span>Akun</span>
                </a>
            </li><!-- End Akun Nav -->

            <li class="nav-item">
                <a class="nav-link collapsed" href="saldo_awal.html">
                    <i class="bx bx-coin-stack"></i><span>Saldo Awal Tahun</span>
                </a>
            </li><!-- End Saldo Awal Tahun Nav -->

            <li class="nav-item">
                <a class="nav-link collapsed" href="transaksi.html">
                    <i class="bi bi-cash"></i><span>Transaksi Jurnal</span>
                </a>
            </li><!-- End Transaksi -->

            <li class="nav-item">
                <a class="nav-link" href="bukubesar.html">
                    <i class="ri-book-2-line"></i><span>Buku Besar</span>
                </a>
            </li><!-- End Buku Besar -->

            <li class="nav-item">
                <a class="nav-link collapsed" href="lapkeuangan.html">
                    <i class="bi bi-clipboard-data"></i><span>Laporan Keuangan</span>
                </a>
            </li><!-- End Laporan keuangan -->
    </aside><!-- End Sidebar-->


    <main id="main" class="main">

        <div class="pagetitle">
            <h1>Buku Besar</h1>
            <nav>
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="dashboard.html">Home</a></li>
                    <li class="breadcrumb-item active"><a>Buku Besar</a></li>
                </ol>
            </nav>
        </div><!-- End Page Title -->

        <section class="section">
            <div class="row">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <div class="card-title">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <div class="col-lg-6">
                                        <label for="input" class="d-flex justify-content-start mb-0">Kode Akun
                                            <select style="width: 75%; margin-left: 10px;" class="form-control"
                                                id="nama_akun" name="nama_akun" required>
                                                <!-- options will be populated here -->
                                                <option selected>Pilih Kode Akun</option>
                                                <option value="kas">100001 - Kas</option>
                                                <option value="kasbank">100002 - Kas Bank</option>
                                                <option value="investasi">100003 - Investasi</option>
                                                <option value="piutang">100100 - Piutang Klien</option>
                                                <option value="perlengkapan habis pakai">100200 - Perlengkapan habis
                                                    pakai</option>
                                                <option value="peralatan produksi">100500 - Peralatan produksi</option>
                                                <option value="akumulasi depresiasi perlatan produksi">100510 -
                                                    Akumulasi depresiasi perlatan produksi</option>
                                                <option value="tanah">100600 - Tanah</option>
                                                <option value="kendaraan">100700 - Kendaraan</option>
                                                <option value="akumulasi depresiasi kendaraan">100710 - Akumulasi
                                                    depresiasi kendaraan</option>
                                                <option value="utang usaha">200100 - Utang usaha</option>
                                                <option value="utang gaji">200200 - Utang Gaji</option>
                                                <option value="pendapatan diterima dimuka">200300 - Pendapatan diterima
                                                    dimuka</option>
                                                <option value="utang bank">200400 - Utang Bank</option>
                                                <option value="modal">300100 - Modal</option>
                                                <option value="deviden">300200 - Deviden</option>
                                                <option value="laba ditahan">300500 - Laba ditahan</option>
                                                <option value="pendapatan project">400100 - Pendapatan Project</option>
                                                <option value="pendapatan lain-lain">400200 - Pendapatan Lain-lain
                                                </option>
                                                <option value="beban gaji,THR,dan honorarium">500001 - Beban gaji, THR
                                                    dan Honorarium</option>
                                                <option value="beban pemasaran">500002 - Beban Pemasaran</option>
                                                <option value="beban konsumsi">500003 - Beban Konsumsi</option>
                                                <option value="beban operasional projek">500004 - Beban Operasional
                                                    Project</option>
                                                <option value="beban sewa">500005 - Beban Sewa</option>
                                                <option value="beban utilitas">500006 - Beban Utilitas</option>
                                                <option value="beban perlengkapan">500007 - Beban Perlengkapan</option>
                                                <option value="beban pemeliharaan">500008 - Beban Pemeliharaan</option>
                                                <option value="beban penyusutan peralatan produksi">500009 - Beban
                                                    Penyusutan Peralatan Produksi</option>
                                                <option value="beban penyusutan kendaraan">500010 - Beban Penyusutan
                                                    Kendaraan</option>
                                                <option value="beban administrasi">500011 - Beban Administrasi</option>
                                                <option value="beban sosial">500012 - Beban Sosial</option>
                                                <option value="beban lain-lain">500013 - Beban Lain-lain</option>
                                                <option value="beban pajak">500014 - Beban Pajak</option>
                                            </select></label>
                                    </div>
                                    <div class="ml-3">
                                        <button id="printBtn" class="btn btn-primary mb-3" style="margin-right: 5px;"><i
                                                class="bi bi-printer"></i></button>
                                        <button id="exportExcelBtn" class="btn btn-success mb-3">Eksport Excel</button>
                                    </div>
                                </div>
                            </div>
                            <!-- Table with stripped rows -->

                            <div id="tabel buku besar">
                                <table class="table" style="width: 100%; height: fit-content;" id="tabel buku besar">
                                    <thead>
                                        <!-- assets -->
                                    </thead>
                                    <tbody>
                                        <table class="table" style="width: 40%;">
                                            <thead>
                                                <tr>
                                                    <th class="table-primary">Saldo Akhir</th>
                                                    <th class="table-primary">Saldo Setelah Penyesuaian</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Rp404.914.955</td>
                                                    <td>Rp404.914.955</td>
                                                </tr>
                                                <tr style="border: none;">
                                                    <td style="border: none;"></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <table class="table">
                                            <thead>
                                                <tr>
                                                    <th class="table-primary text-center" data-type="date"
                                                        data-format="DD/MM/YYYY">Tanggal</th>
                                                    <th class="table-primary text-center">Kode Jurnal</th>
                                                    <th class="table-primary text-center">Kode Akun</th>
                                                    <th class="table-primary text-center">Nama Transaksi</th>
                                                    <th class="table-primary text-center">Arus Kas</th>
                                                    <th class="table-primary text-center">Debit</th>
                                                    <th class="table-primary text-center">Kredit</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td class="text-center">01/01/2023</td>
                                                    <td class="text-center">JU</td>
                                                    <td>500003</td>
                                                    <td>Pembelian Makan dan Minum 31 Desember 2023</td>
                                                    <td>Operasi</td>
                                                    <td>Rp 124.000</td>
                                                    <td>Rp 0 </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">02/01/2023</td>
                                                    <td class="text-center">JU</td>
                                                    <td>500003</td>
                                                    <td>Pembelian Makan</td>
                                                    <td>Operasi</td>
                                                    <td>Rp 30.000</td>
                                                    <td>Rp 0 </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">03/01/2023</td>
                                                    <td class="text-center">JU</td>
                                                    <td>500006</td>
                                                    <td>Zoom Teleconference</td>
                                                    <td>Operasi</td>
                                                    <td>Rp 268.108</td>
                                                    <td>Rp 0 </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">05/01/2023</td>
                                                    <td class="text-center">JU</td>
                                                    <td>500006</td>
                                                    <td>Musik Stasiun IDTVMu</td>
                                                    <td>Operasi</td>
                                                    <td>Rp 128.791</td>
                                                    <td>Rp 0 </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">07/01/2023</td>
                                                    <td class="text-center">JU</td>
                                                    <td>500003</td>
                                                    <td>Gula Sachet, Le Minerale, Makan, dan Snack Box</td>
                                                    <td>Operasi</td>
                                                    <td>Rp 251.700</td>
                                                    <td>Rp 0 </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">08/01/2023</td>
                                                    <td class="text-center">JU</td>
                                                    <td>500006</td>
                                                    <td>Feesible jenius</td>
                                                    <td>Operasi</td>
                                                    <td>Rp 10.000</td>
                                                    <td>Rp 0 </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">09/01/2023</td>
                                                    <td class="text-center">JU</td>
                                                    <td>500003</td>
                                                    <td>Snack Pelepasan Magang</td>
                                                    <td>Operasi</td>
                                                    <td>Rp 290.500</td>
                                                    <td>Rp 0 </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">10/01/2023</td>
                                                    <td class="text-center">JU</td>
                                                    <td>500003</td>
                                                    <td>Makan Pelepasan Magang</td>
                                                    <td>Operasi</td>
                                                    <td>Rp 204.000</td>
                                                    <td>Rp 0 </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">11/01/2023</td>
                                                    <td class="text-center">JU</td>
                                                    <td>500003</td>
                                                    <td>Snack Pelepasan Magang</td>
                                                    <td>Operasi</td>
                                                    <td>Rp 50.000</td>
                                                    <td>Rp 0 </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">12/01/2023</td>
                                                    <td class="text-center">JU</td>
                                                    <td>500003</td>
                                                    <td>Makan dan Service Zhiyun</td>
                                                    <td>Operasi</td>
                                                    <td>Rp 165.000</td>
                                                    <td>Rp 0 </td>
                                                </tr>
                                                <tr>
                                                    <td class="text-center">12/01/2023</td>
                                                    <td class="text-center">JU</td>
                                                    <td>500008</td>
                                                    <td>Makan dan Service Zhiyun</td>
                                                    <td>Operasi</td>
                                                    <td>Rp 1.58.500</td>
                                                    <td>Rp 0</td>
                                                </tr>
                                            </tbody>
                                        </table>
                            </div>
                            <!-- End Table with stripped rows -->
                            </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            </div>
        </section>

    </main><!-- End #main -->

    <!-- ======= Footer ======= -->
    <footer id="footer" class="footer">
        <nav class="d-flex justify-content-center">
            <div class="copyright">
                &copy; Copyright <strong><span>tvMu</span></strong>. All Rights Reserved Designed by <a
                    href="https://bootstrapmade.com/">BootstrapMade</a>
            </div>
            <div class="credits">
                <!-- All the links in the footer should remain intact. -->
                <!-- You can delete the links only if you purchased the pro version. -->
                <!-- Licensing information: https://bootstrapmade.com/license/ -->
                <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/nice-admin-bootstrap-admin-html-template/ -->

            </div>
        </nav>
    </footer><!-- End Footer -->

    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>

    <!-- Vendor JS Files -->
    <script src="assets/vendor/apexcharts/apexcharts.min.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/chart.js/chart.umd.js"></script>
    <script src="assets/vendor/echarts/echarts.min.js"></script>
    <script src="assets/vendor/quill/quill.js"></script>
    <script src="assets/vendor/simple-datatables/simple-datatables.js"></script>
    <script src="assets/vendor/tinymce/tinymce.min.js"></script>
    <script src="assets/vendor/php-email-form/validate.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <script>
        // Fungsi untuk mencetak tabel
        document.getElementById('printBtn').addEventListener('click', function () {
            var element = document.getElementById('tabel buku besar');
            var selectedAccount = document.getElementById('nama_akun').value; // Get the selected account
            var win = window.open('', '', 'height=700,width=700');
            var today = new Date();
            var options = { year: 'numeric', month: 'long', day: 'numeric' };
            var formattedDate = today.toLocaleDateString('id-ID', options);
            win.document.write('<html><head><title>Cetak Tabel Buku Besar</title>');
            // CSS untuk border tabel
            win.document.write('<style>');
            win.document.write('table { border-collapse: collapse; width: 100%; }');
            win.document.write('th, td { border: 1px solid black; padding: 8px; text-align: left; }');
            win.document.write('th { background-color: #f2f2f2; }'); // Warna latar belakang untuk header
            win.document.write('h2 { text-align: center; }'); // Center the title
            win.document.write('img { display: block; margin: 0 auto; }'); // Center the image
            win.document.write('</style>');
            win.document.write('</head><body>');

            // kop surat
            win.document.write('<table width="100%">');
            win.document.write('<tr>');
            win.document.write('<td style="text-align: center; border:none;"><img src="assets/img/logo_baru.png" width="100" alt="Logo"></td>'); // Ganti dengan jalur gambar yang sesuai
            win.document.write('<td style="text-align: center; border:none;"><h2>Buku Besar</h2></td>');
            win.document.write('<td style="text-align: center; border:none;"><h4>Periode Tahun 2024</h4></td>');
            win.document.write('</tr>');
            win.document.write('</table>');
            win.document.write('<hr>'); // Garis pemisah antara kop surat dan tabel
            win.document.write('<h4>Kode Akun : ' + selectedAccount + '</h4>'); // Center the account code

            win.document.write(element.outerHTML);

            // footer
            win.document.write('<div class="footer">');
            win.document.write('<table width="100%">');
            win.document.write('<tr style="border:none">');
            win.document.write('<td style="text-align: center; width: 50%; border:none">');
            win.document.write('<p>Manajer</p>');
            win.document.write('<br><br><br>'); // Ruang untuk tanda tangan
            win.document.write('<p>(Nama Manajer)</p>'); // Ganti dengan nama kepala bidang
            win.document.write('</td>');
            win.document.write('<p style="text-align: right">'+'Yogyakarta, ' + formattedDate + '</p>');
            win.document.write('<td style="text-align: center; width: 50%; border:none">');
            win.document.write('<p> Keuangan TvMu</p>');
            win.document.write('<br><br><br>'); // Ruang untuk tanda tangan
            win.document.write('<p>(Nama Keuangan TvMu)</p>'); // Ganti dengan nama manajer
            win.document.write('</td>');
            win.document.write('</tr>');
            win.document.write('</table>');
            win.document.write('</div>');

            win.document.write('</body></html>');
            win.document.close();
            win.print();
        });

        // Fungsi untuk mengekspor tabel ke Excel
        document.getElementById('exportExcelBtn').addEventListener('click', function () {
            var element = document.getElementById('tabel buku besar');
            var selectedAccount = document.getElementById('nama_akun').value; // Get the selected account

            // Create a new row for the title
            var titleRow = document.createElement("tr");
            var titleCell = document.createElement("td");
            titleCell.colSpan = 7; // Adjust the colspan based on your table structure
            titleCell.innerText = 'Buku Besar';
            titleCell.style.fontWeight = 'bold'; // Make the title bold
            titleCell.style.fontSize = '16px'; // Adjust font size if needed
            titleCell.style.textAlign = 'center'; // Center the title
            titleRow.appendChild(titleCell);

            // Create a new row for the selected account
            var accountRow = document.createElement("tr");
            var accountCell = document.createElement("td");
            accountCell.colSpan = 7; // Adjust the colspan based on your table structure
            accountCell.innerText = 'Kode Akun : ' + selectedAccount;
            accountCell.style.textAlign = 'center'; // Center the account code
            accountRow.appendChild(accountCell);

            // Append the title row and account row to the table before exporting
            var tbody = element.querySelector("tbody");
            tbody.insertBefore(accountRow, tbody.firstChild);
            tbody.insertBefore(titleRow, tbody.firstChild);

            // Convert the table to a workbook
            var wb = XLSX.utils.table_to_book(element, { sheet: "Data" });

            // Set column widths
            var ws = wb.Sheets["Data"];
            ws['!cols'] = [
                { wpx: 100 }, // Width for Date column
                { wpx: 100 }, // Width for Kode Jurnal column
                { wpx: 100 }, // Width for Kode Akun column
                { wpx: 300 }, // Width for Nama Transaksi column
                { wpx: 100 }, // Width for Arus Kas column
                { wpx: 100 }, // Width for Debit column
                { wpx: 100 }  // Width for Kredit column
            ];

            // Write the file
            XLSX.writeFile(wb, 'tabel buku besar.xlsx');

            // Remove the title and account rows after exporting to keep the original table intact
            tbody.removeChild(accountRow);
            tbody.removeChild(titleRow);
        });
    </script>
    <!-- Template Main JS File -->
    <script src="assets/js/main.js"></script>

</body>

</html>
